<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mass Hymn Selection</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
      }

      .form-group {
        margin-bottom: 15px;
      }

      label {
        display: block;
        margin-bottom: 5px;
      }

      .columns {
        display: flex;
        justify-content: space-between;
      }

      .columns div {
        flex: 1;
        padding: 0 10px;
      }

      .columns div input {
        margin-right: 5px;
      }

      .checkbox-container {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
      }

      .checkbox-container div {
        display: flex;
        align-items: center;
      }

      .checkbox-container div input {
        margin-right: 5px;
      }
    </style>
  </head>
  <body>
    <h1>Mass Hymn Selection</h1>
    <form id="hymn-form">
      <div class="form-group">
        <label for="gathering-hymn">Gathering Hymn:</label>
        <input type="text" id="gathering-hymn" name="gathering-hymn" required />
      </div>
      <div class="form-group">
        <label for="hymn-number">Hymn Number:</label>
        <input type="number" id="hymn-number" name="hymn-number" required />
      </div>
      <div class="form-group">
        <label for="hymn-title">Hymn Title:</label>
        <input type="text" id="hymn-title" name="hymn-title" required />
      </div>
      <div class="form-group">
        <label>Parts of the Mass:</label>
        <div class="checkbox-container">
          <div>
            <input
              type="checkbox"
              id="gathering"
              name="part"
              value="Gathering"
            />
            <label for="gathering">Gathering</label>
          </div>
          <div>
            <input type="checkbox" id="psalm" name="part" value="Psalm" />
            <label for="psalm">Psalm</label>
          </div>
          <div>
            <input
              type="checkbox"
              id="offertory"
              name="part"
              value="Offertory"
            />
            <label for="offertory">Offertory</label>
          </div>
          <div>
            <input
              type="checkbox"
              id="communion"
              name="part"
              value="Communion"
            />
            <label for="communion">Communion</label>
          </div>
          <div>
            <input
              type="checkbox"
              id="recessional"
              name="part"
              value="Recessional"
            />
            <label for="recessional">Recessional</label>
          </div>
        </div>
      </div>
      <div class="form-group columns">
        <label>Week:</label>
        <div>
          <input type="radio" id="week1" name="week" value="Week 1" />
          <label for="week1">Week 1</label>
        </div>
        <div>
          <input type="radio" id="week2" name="week" value="Week 2" />
          <label for="week2">Week 2</label>
        </div>
        <div>
          <input type="radio" id="week3" name="week" value="Week 3" />
          <label for="week3">Week 3</label>
        </div>
        <div>
          <input type="radio" id="week4" name="week" value="Week 4" />
          <label for="week4">Week 4</label>
        </div>
      </div>
      <button type="submit">Submit</button>
    </form>
    <div id="result"></div>
    <script>
      document
        .getElementById("hymn-form")
        .addEventListener("submit", function (event) {
          event.preventDefault();

          const hymnNumber = document.getElementById("hymn-number").value;
          const hymnTitle = document.getElementById("hymn-title").value;

          const parts = [];
          document
            .querySelectorAll('input[name="part"]:checked')
            .forEach((checkbox) => {
              parts.push(checkbox.value);
            });

          const week = document.querySelector(
            'input[name="week"]:checked'
          ).value;

          google.script.run
            .withSuccessHandler((response) => {
              document.getElementById("result").innerText = response;
            })
            .processForm(hymnNumber, hymnTitle, parts, week);
        });
    </script>
  </body>
</html>
