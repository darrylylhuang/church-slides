<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mass Hymn Selection</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
      }

      .form-group {
        margin-bottom: 15px;
      }

      label {
        margin-right: 10px;
      }

      /* Container for the form columns */
      #form-column {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
      }

      /* Each form group (label + input pair) */
      .form-group {
        display: flex;
        flex-direction: row;
        align-items: center;
        margin-bottom: 10px;
      }

      /* Style for the labels */
      .form-group label {
        min-width: 150px; /* Adjust as necessary */
        text-align: right;
        padding-right: 10px;
      }

      /* Style for the input fields */
      .form-group input[type="text"],
      .form-group input[type="checkbox"] {
        flex: 1;
        padding: 5px;
      }

      #hymn-form {
        display: flex;
        justify-content: space-between; /* Evenly distribute columns */
        gap: 20px; /* Gap between columns */
      }

      /* CSS for each column */
      .column {
        flex: 1; /* Each column takes up equal space */
        padding: 10px; /* Padding for content */
        border: 1px solid #ccc; /* Border for clarity */
      }
    </style>
  </head>
  <body>
    <h1>Mass Hymn Selection</h1>
    <form id="hymn-form">
      <div id="form-column">
        <div class="form-group">
          <label for="gathering-hymn">Gathering Hymn</label>
          <input
            type="text"
            id="gathering-hymn"
            name="gathering-hymn"
            required
          />
        </div>
        <div class="form-group">
          <label for="gloria">Gloria</label>
          <input type="checkbox" id="gloria" name="gloria" value="included" />
        </div>
        <div class="form-group">
          <label for="psalm">Psalm</label>
          <input type="text" id="psalm" name="psalm" required />
        </div>
        <div class="form-group">
          <label for="gospel-acclamation">Gospel Acclamation</label>
          <input type="radio" id="gospel-none" name="gospel" value="none" />
          <input type="radio" id="gospel-norm" name="gospel" value="normal" />
          <input type="radio" id="gospel-lent" name="gospel" value="lenten" />
        </div>
        <div class="form-group">
          <label for="offertory">Offertory Hymn</label>
          <input type="text" id="offertory" name="offertory" required />
        </div>
        <div class="form-group">
          <label for="memorial">Memorial Acclamation</label>
          <input type="radio" id="memorial0" name="memorial" value="0" />
          <input type="radio" id="memorial1" name="memorial" value="1" />
          <input type="radio" id="memorial2" name="memorial" value="2" />
          <input type="radio" id="memorial3" name="memorial" value="3" />
        </div>
        <div class="form-group">
          <label for="communion">Communion Hymn</label>
          <input type="text" id="communion" name="communion" required />
        </div>
        <div class="form-group">
          <label for="recessional">Recessional Hymn</label>
          <input type="text" id="recessional" name="recessional" required />
        </div>
        <div class="form-group">
          <label for="amen">Amen</label>
          <input type="checkbox" id="amen" name="amen" value="included" />
        </div>
        <div class="form-group">
          <label for="lamb">Lamb of God</label>
          <input type="checkbox" id="lamb" name="lamb" value="included" />
        </div>
      </div>
      <div class="form-group columns">
        <label>Week:</label>
        <div>
          <input type="radio" id="week1" name="week" value="Week 1" />
          <label for="week1">Week 1</label>
        </div>
        <div>
          <input type="radio" id="week2" name="week" value="Week 2" />
          <label for="week2">Week 2</label>
        </div>
        <div>
          <input type="radio" id="week3" name="week" value="Week 3" />
          <label for="week3">Week 3</label>
        </div>
        <div>
          <input type="radio" id="week4" name="week" value="Week 4" />
          <label for="week4">Week 4</label>
        </div>
      </div>
      <button type="submit">Submit</button>
    </form>
    <div id="result"></div>
    <script>
      let _countSundaysInCurrentMonth = (function () {
        // Get current date
        var today = new Date();

        // Get the year and month
        var year = today.getFullYear();
        var month = today.getMonth();

        // Initialize counter for Sundays
        var sundaysCount = 0;

        // Loop through each day of the month
        for (
          var day = 1;
          day <= new Date(year, month + 1, 0).getDate();
          day++
        ) {
          var currentDate = new Date(year, month, day);
          // Check if the current day is a Sunday (day 0 in JavaScript Date object)
          if (currentDate.getDay() === 0) {
            sundaysCount++;
          }
        }

        // Return the number of Sundays found
        return sundaysCount;
      })();

      let index = (function () {
        "use strict";

        var hymnForm = document.getElementById("hymn-form");
        var numberOfDivs = _countSundaysInCurrentMonth;
        for (let i = 0; i < numberOfDivs; i++) {
          var div = document.createElement("div");
          // TODO: make real divs
          div.textContent = `Div ${i + 1}`;
          div.classList.add("column");
          hymnForm.appendChild(div);
        }
      })();
      index;
    </script>
    <script>
      document
        .getElementById("hymn-form")
        .addEventListener("submit", function (event) {
          event.preventDefault();

          const hymnNumber = document.getElementById("hymn-number").value;
          const hymnTitle = document.getElementById("hymn-title").value;

          const parts = [];
          document
            .querySelectorAll('input[name="part"]:checked')
            .forEach((checkbox) => {
              parts.push(checkbox.value);
            });

          const week = document.querySelector(
            'input[name="week"]:checked'
          ).value;

          google.script.run
            .withSuccessHandler((response) => {
              document.getElementById("result").innerText = response;
            })
            .processForm(hymnNumber, hymnTitle, parts, week);
        });
    </script>
  </body>
</html>
